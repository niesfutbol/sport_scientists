---
title: "actividad_4"
author: "Nepo Rojas"
date: "2024-09-23"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

``` {r libraries}
library(tidyverse)
```

```{r read data}
path_data <- "/home/rstudio/workspace/datos/actividad_2_2.csv"
data <- read_csv(path_data, show_col_types = FALSE) |>
  select(-c(player_id))
```
## Presentación
El código con el que generamos los resultados de este reporte lo encontrarás [`niesfutbol/sport_scientists/src/activity_4.Rmd`](https://github.com/niesfutbol/sport_scientists/blob/develop/src/activity_4.Rmd).
El código podría diferir del presente en este reporte. La versión actualizada del código está en la
liga al repositorio.

## Correlación de variables
Revisaremos la correlación que exite entre las variables utilizando la función `cor()`. Para ver una representación gráfica de ese resultado usaremos la función `corrplot::corrplot()`.

``` {r correlation}
variable_correlation <- cor(data)
corrplot::corrplot(variable_correlation)
```
En la figura de arriba vemos las correlaciones positivas representadas con color azul. Las correlaciones negativas son presentadas en color rojo. La intendidad del color y el radio de los círculos son proporcionales a la magnitud de la correlación. A mayor correlación mayor intensidad y mayor el radio.

## Regresión lineal
Haremos una regresión lineal para modelar a la variable `jump_height_flight_time` en función de las variables `countermovement_depth` y `peak_power_bm`. En la figura de arriba podemos ver que `jump_height_flight_time` está correlacionada negativamente con `countermovement_depth` pues el círculo de la intersección de las dos variables es rojo. De manera similar, vemos que la variable  `jump_height_flight_time` está correlacionada positivamente con `peak_power_bm`.

``` {r linear model}
linear_model <- lm(jump_height_flight_time ~ countermovement_depth + peak_power_bm, data = data)
resumen <- summary(linear_model)
r_squared <- resumen$r.squared
```
El coeficiente de correlación cuadrática es $r²$ = `r r_squared`.

``` {r stepwise}
# Initialize a model with all predictors
backward_model <- lm(jump_height_flight_time ~ ., data = data)

# Backward stepwise regression
stepwise_model <- step(backward_model, direction = "both")
summary(stepwise_model)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r plot}
plot(data$peak_power_bm, data$jump_height_flight_time, 
     main = "Jump height flight vs Peak power", 
     xlab = "Peak power", ylab = "Jump height flight", pch = 20
     )
abline(lm(jump_height_flight_time ~ peak_power_bm, data = data), col = "black", lwd = 2)
points(sort(data$peak_power_bm), linear_model$fitted.values, col = "purple", pch = 20)
points(sort(data$peak_power_bm), stepwise_model$fitted.values, col = "red")
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
